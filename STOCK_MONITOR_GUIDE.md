# 股票监控功能使用指南

## 🎯 功能概述

股票监控模块允许您：
- 添加股票监控规则
- 设置技术指标预警（MA、RSI、MACD等）
- 实时监控股价变化
- 接收浏览器通知提醒
- 查看预警触发历史

## 📋 支持的预警类型

### 1. 移动平均线 (MA) 预警
- **MA突破**: 股价向上突破MA线时提醒
- **MA支撑**: 股价跌破MA线时提醒
- **示例**: 当IONQ股价跌破MA20时提醒

### 2. 价格预警
- **价格高于**: 股价高于指定价位时提醒
- **价格低于**: 股价低于指定价位时提醒
- **示例**: 当IONQ股价低于$10时提醒

### 3. RSI指标预警
- **RSI超买**: RSI > 70时提醒
- **RSI超卖**: RSI < 30时提醒

### 4. 均线缠绕预警 🔥
- **均线缠绕**: 多条均线相互靠近，市场震荡整理
- **均线发散**: 均线从缠绕状态开始发散，趋势明确
- **示例**: 当MA5、MA10、MA20缠绕时提醒

### 5. 均线附近预警 🔥
- **接近均线**: 股价接近重要均线支撑阻力位
- **均线附近震荡**: 股价在均线附近小幅波动
- **示例**: 当股价接近MA20±2%时提醒

### 6. 其他技术指标
- EMA (指数移动平均线)
- MACD
- 布林带
- 成交量预警

## 🔧 配置步骤

### 1. 获取长桥API密钥

1. 访问 [长桥开发者中心](https://open.longportapp.com/account)
2. 注册并登录账户
3. 创建应用获取以下信息：
   - API Key
   - API Secret
   - Access Token

### 2. 配置环境变量

复制 `.env.example` 为 `.env` 并填入您的API信息：

```bash
cp .env.example .env
```

编辑 `.env` 文件：
```env
REACT_APP_LONGPORT_API_KEY=your_api_key_here
REACT_APP_LONGPORT_API_SECRET=your_api_secret_here
REACT_APP_LONGPORT_ACCESS_TOKEN=your_access_token_here
REACT_APP_LONGPORT_ENVIRONMENT=sandbox
```

### 3. 启用浏览器通知

首次访问监控页面时，浏览器会请求通知权限，请点击"允许"。

## 📱 使用方法

### 添加监控规则

1. 访问"股票监控"页面
2. 点击"添加预警"按钮
3. 填写以下信息：
   - **股票代码**: 如 `IONQ.US`、`AAPL.US`、`700.HK`
   - **股票名称**: 如 `IonQ Inc`
   - **预警规则**: 选择预设的监控规则
   - **参数设置**: 根据规则类型设置相应参数

### 监控规则示例

#### 示例1: MA20支撑预警
```
股票代码: IONQ.US
股票名称: IonQ Inc
预警规则: MA20支撑 - 股价跌破20日移动平均线
```

#### 示例2: 价格预警
```
股票代码: AAPL.US
股票名称: Apple Inc
预警规则: 价格预警 - 股价达到指定价位
目标价格: 150.00
```

#### 示例3: RSI超卖预警
```
股票代码: TSLA.US
股票名称: Tesla Inc
预警规则: RSI超卖 - RSI指标超卖信号
```

#### 示例4: 均线缠绕预警 🔥
```
股票代码: IONQ.US
股票名称: IonQ Inc
预警规则: 均线缠绕 - 多条均线相互缠绕，市场震荡整理
均线周期: MA5, MA10, MA20
缠绕阈值: 2%
```

#### 示例5: 均线附近预警 🔥
```
股票代码: AAPL.US
股票名称: Apple Inc
预警规则: 接近均线 - 股价接近重要均线支撑阻力位
均线周期: MA20
距离阈值: ±2%
```

#### 示例6: 均线发散预警 🔥
```
股票代码: NVDA.US
股票名称: NVIDIA Corp
预警规则: 均线发散 - 多条均线开始发散，趋势明确
均线周期: MA5, MA10, MA20
缠绕阈值: 2%
```

### 启动监控

1. 添加完监控规则后
2. 点击"开始监控"按钮
3. 系统将实时监控股价变化
4. 满足条件时会发送通知

## 🔔 通知方式

### 浏览器通知
- 实时弹出通知
- 显示股票代码和触发条件
- 点击通知可跳转到监控页面

### 页面内通知
- 监控页面右侧显示最近触发记录
- 实时更新触发状态
- 显示触发时间和详细信息

## 📊 监控状态

监控页面顶部显示：
- **监控状态**: 运行中/已停止
- **监控股票**: 当前监控的股票数量
- **活跃预警**: 启用的预警规则数量
- **今日触发**: 今天触发的预警次数

## ⚙️ 高级设置

### 均线缠绕参数详解
- **均线周期组合**: 默认使用MA5、MA10、MA20
- **缠绕阈值**: 当最大均线值与最小均线值的差距小于阈值时认为缠绕
- **计算公式**: `缠绕程度 = (最大MA - 最小MA) / 平均MA × 100%`
- **推荐阈值**: 1-3%，数值越小越敏感

### 均线附近参数详解
- **距离阈值**: 股价与均线的距离百分比
- **计算公式**: `距离 = |股价 - 均线值| / 均线值 × 100%`
- **接近判断**: 距离 ≤ 阈值
- **范围内判断**: 距离 ≤ 阈值/2
- **推荐阈值**: 1-5%，根据股票波动性调整

### 冷却期设置
- 每个预警规则有5分钟冷却期
- 避免频繁触发相同预警
- 可在代码中调整冷却时间

### 数据更新频率
- 默认5秒检查一次
- 可通过环境变量调整
- 建议不要设置过于频繁

## 🚨 注意事项

### API限制
- 长桥API有调用频率限制
- 建议合理设置监控股票数量
- 避免过于频繁的数据请求

### 行情权限
- 需要相应的行情权限
- 港股需要BMP权限
- 美股需要LV1权限
- 可在长桥APP中购买权限

### 网络连接
- 需要稳定的网络连接
- WebSocket断线会自动重连
- 建议在稳定网络环境下使用

## 🛠️ 故障排除

### 常见问题

#### 1. 无法连接到长桥API
- 检查API密钥是否正确
- 确认网络连接正常
- 验证API权限设置

#### 2. 收不到通知
- 检查浏览器通知权限
- 确认监控状态为"运行中"
- 验证预警规则设置正确

#### 3. 股票数据不更新
- 检查股票代码格式
- 确认市场交易时间
- 验证行情权限

### 调试方法

1. 打开浏览器开发者工具
2. 查看Console标签页的错误信息
3. 检查Network标签页的API请求
4. 确认WebSocket连接状态

## 📈 支持的市场

- **美股**: 使用 `.US` 后缀，如 `AAPL.US`
- **港股**: 使用 `.HK` 后缀，如 `700.HK`
- **A股**: 使用 `.SH` 或 `.SZ` 后缀，如 `600519.SH`

## 📈 实际应用场景

### 均线缠绕的应用
1. **震荡整理识别**: 当多条均线缠绕时，表示市场处于震荡状态
2. **突破前兆**: 缠绕后往往伴随着方向性突破
3. **交易策略**: 缠绕期间减少交易，等待发散信号

### 均线附近的应用
1. **支撑阻力**: 重要均线常作为支撑或阻力位
2. **入场时机**: 股价回调至均线附近可能是买入机会
3. **止损设置**: 跌破重要均线可作为止损信号

### 组合使用建议
1. **多时间框架**: 结合不同周期的均线分析
2. **量价配合**: 关注成交量的配合情况
3. **趋势确认**: 结合RSI、MACD等指标确认

## 🔮 未来功能

- [ ] 邮件通知
- [ ] 短信通知
- [ ] 微信通知
- [ ] 更多技术指标
- [ ] 自定义指标公式
- [ ] 预警历史统计
- [ ] 批量导入监控列表
- [x] 均线缠绕检测 ✅
- [x] 均线附近预警 ✅

## 📞 技术支持

如有问题，请：
1. 查看本文档的故障排除部分
2. 检查长桥API文档
3. 提交GitHub Issue

---

**免责声明**: 本功能仅供学习和参考使用，不构成投资建议。投资有风险，请谨慎决策。
